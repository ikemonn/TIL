# 割り込み
## Linuxカーネルの割り込み処理の特徴
### 応答性の確保
  - 各割り込み処理自体を応答性を必要とする部分と必要としない部分に分ける
    - 応答性が必要な部分はなるべく実行時間が短くなるように設計し、ハードウェア割り込みハンドラで実行する
    - 応答性を必要としない部分はまとめて後から実行する
      - ソフト割り込み
### マルチプロセッサへの対応
- 全てのCPUは対等で、どの種類の割り込みハンドラでも処理できる
  - ハードウェアが対応していれば、最も負荷が低いCPUに対し割り込みを発生させて処理させることが出来る
- 同じIRQに対するものでないかぎり、複数のCPU上で同時にそれぞれハードウェア割り込みハンドラが動作できる
- ソフト割り込みハンドラはその要因を作ったハードウェア割り込みハンドラと同じCPU上で動く
  - キャッシュの再利用ができて効率的
- 特定の割り込みハンドラの実行を明示的にあるCPUに任せることも出来る

### 割り込みスタック
- 割り込みが発生した時、その時点で実行中のカレントプロセスのカーネルスタックを利用して動作する

## ハードウェア割り込み処理
### 割り込みの種類
- 外部装置割り込み
  - ネットワークカードや端末装置が生成する割り込み
  - その割り込みに対するデバイスドライバの割り込みハンドラを起動する
- タイマー割り込み
  - タイマーコントローラが一定周期で割り込みを発生させる
  - グローバルタイマー割り込みとローカルタイマー割り込みがある
- プロセッサ間割り込み
  - マルチプロセッサ環境において他のCPUへ何らかの事象を通知するために利用される
- NMI(マスク不可割り込み)
  - CPUの割り込み受け取りを拒否できない割り込み
  - 緊急時の障害対応目的で使われる
